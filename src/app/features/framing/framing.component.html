<div class="container">
  <mat-horizontal-stepper
    linear
    #stepper
    class="user-select-none"
    (selectionChange)="markFormAsTouched($event)"
  >
    <ng-template matStepperIcon="edit">
      <i-feather
        name="check"
        class="step-label-heading-completed icon"
      ></i-feather>
    </ng-template>
    <mat-step
      #stepOne
      *ngIf="dimensionsInputAttributeForm"
      [stepControl]="dimensionsInputAttributeForm"
    >
      <form [formGroup]="dimensionsInputAttributeForm">
        <ng-template matStepLabel>
          <div class="click-holder" (click)="checkStepBeforeSwitch(0)"></div>
          <span
            class="step-label-heading bold"
            [class.step-label-heading-active]="stepper.selected === stepOne"
            [class.step-label-heading-completed]="
              stepOne.completed && stepper.selected !== stepOne
            "
            >{{ "inputDimensions" | translate }}</span
          >
        </ng-template>

        <div class="step-content box-sizing-border-box">
          <h1 class="step-content-label bold">
            {{ "inputDimensions" | translate }}
          </h1>

          <div class="group-container">
            <div class="row-container">
              <mat-form-field>
                <input
                  type="number"
                  matInput
                  formControlName="count"
                  placeholder="{{ 'inputCount' | translate }}"
                />
              </mat-form-field>
            </div>
            <div class="row-container">
              <mat-form-field class="element">
                <input
                  type="number"
                  matInput
                  formControlName="width"
                  placeholder="{{ 'width' | translate }}"
                />
              </mat-form-field>
              <div class="element">X</div>
              <mat-form-field class="element">
                <input
                  type="number"
                  matInput
                  formControlName="height"
                  placeholder="{{ 'height' | translate }}"
                />
              </mat-form-field>
              <div class="uom">{{ invoice.dimensions.uom }}</div>
            </div>
            <div class="row-container-data" *ngIf="!invoice.mirror">
              <app-button
                [text]="'glass' | translate"
                buttonSize="middle"
                fullWidth="true"
                (clickEvent)="selectGlass()"
              ></app-button>
              <div class="object-name" [ngClass]="invoice?.glass?.name">
                <i-feather
                  [name]="invoice?.glass?.name ? 'check' : 'alert-triangle'"
                  [class.success]="invoice?.glass?.name"
                  [class.danger]="!invoice?.glass?.name"
                ></i-feather>
                {{ invoice?.glass?.name || "glassNotSelected" | translate }}
              </div>
            </div>
            <div class="row-container-data">
              <app-button
                [text]="'passpartu' | translate"
                buttonSize="middle"
                fullWidth="true"
                (clickEvent)="selectPasspartu()"
              ></app-button>
              <div class="object-name">
                <i-feather
                  [name]="
                    invoice?.passpartu?.value?.name ? 'check' : 'alert-triangle'
                  "
                  [class.success]="invoice?.passpartu?.value?.name"
                  [class.danger]="!invoice?.passpartu?.value?.name"
                ></i-feather>
                {{
                  invoice?.passpartu?.value?.name || "passpartuNotSelected"
                    | translate
                }}
                <span *ngIf="invoice?.passpartu?.width">
                  ,
                  {{
                    " " +
                      ("width" | translate) +
                      ": " +
                      invoice?.passpartu?.width
                  }}
                </span>
              </div>
            </div>
            <div class="row-container-data" *ngIf="!invoice.glass">
              <app-button
                [text]="'mirror' | translate"
                buttonSize="middle"
                fullWidth="true"
                (clickEvent)="selectMirror()"
              ></app-button>
              <div class="object-name">
                <i-feather
                  [name]="invoice?.mirror?.name ? 'check' : 'alert-triangle'"
                  [class.success]="invoice?.mirror?.name"
                  [class.danger]="!invoice?.mirror?.name"
                ></i-feather>
                {{ invoice?.mirror?.name || "mirrorNotSelected" | translate }}
              </div>
            </div>
          </div>
          <div class="footer box-sizing-border-box">
            <app-button
              [text]="'cancel' | translate"
              color="secondary"
              buttonSize="middle"
              (clickEvent)="cancel()"
            ></app-button>
            <app-button
              [text]="'next' | translate"
              buttonSize="middle"
              [color]="'success'"
              (clickEvent)="stepper.next(); checkStepBeforeSwitch(1)"
            ></app-button>
          </div>
        </div>
      </form>
    </mat-step>

    <mat-step #stepTwo>
      <ng-template matStepLabel>
        <span
          class="step-label-heading bold"
          [class.step-label-heading-active]="stepper.selected === stepTwo"
          [class.step-label-heading-completed]="
            stepTwo.completed && stepper.selected !== stepTwo
          "
          >{{ "frames" | translate }}</span
        >
      </ng-template>

      <div class="step-content">
        <div class="group-container">
          <div
            class="row-container"
            *ngFor="let frame of invoice.selectedFrames; let i = index"
          >
            <div class="frame-name">
              <span *ngIf="frame.name">{{ frame.name }}</span>
              <span *ngIf="frame.uom"
                >{{ ", " + ("uom" | translate) }}{{ ": " + frame.uom }}</span
              >
              <span *ngIf="frame.pricePerUom"
                >{{ ", " + ("ppUom" | translate)
                }}{{ ": " + frame.pricePerUom }}</span
              >
            </div>
            <app-button
              [iconName]="'edit'"
              [isSquare]="true"
              [buttonSize]="'small'"
              [isTransparentMode]="true"
              (clickEvent)="changeAddedFrame(frame, i)"
              class="button"
            ></app-button>
            <app-button
              [iconName]="'trash'"
              [buttonSize]="'small'"
              [isSquare]="true"
              [isTransparentMode]="true"
              (clickEvent)="removeAddedFrame(i)"
              class="button"
            ></app-button>
          </div>
          <div class="row-container">
            <div class="add-frame-button">
              <app-button
                [buttonSize]="'middle'"
                [text]="'addFrame' | translate"
                [fullWidth]="true"
                (clickEvent)="addNewFrameToInvoice()"
              ></app-button>
            </div>
          </div>
        </div>
        <div class="footer box-sizing-border-box">
          <app-button
            [text]="'previous' | translate"
            color="secondary"
            buttonSize="middle"
            (clickEvent)="stepper.previous()"
          ></app-button>
          <app-button
            [text]="'next' | translate"
            buttonSize="middle"
            [color]="'success'"
            (clickEvent)="stepper.next(); checkStepBeforeSwitch(2)"
          ></app-button>
        </div>
      </div>
    </mat-step>

    <mat-step #stepThree>
      <ng-template matStepLabel>
        <span
          class="step-label-heading bold"
          [class.step-label-heading-active]="stepper.selected === stepThree"
          [class.step-label-heading-completed]="
            stepThree.completed && stepper.selected !== stepThree
          "
          >{{ "invoice" | translate }}</span
        >
      </ng-template>
      <div class="step-content">
        <div class="grid-container">
          <div class="grid-item table-header">
            {{ "description" | translate }}
          </div>
          <div class="grid-item table-header">
            {{ "price" | translate }}
          </div>
          <div class="grid-item table-header">
            {{ "edit" | translate }}
          </div>
          <div class="grid-item table-header">
            {{ "delete" | translate }}
          </div>
          <div class="grid-item description">
            <div>
              <span class="description">{{ "picture" | translate }}</span>
              <span>: </span>
              <span>{{ invoice.dimensions.width }}</span>
              <span> X </span>
              <span>{{ invoice.dimensions.height }}</span>
              <span> </span>
              <span>{{ invoice.dimensions.uom }}</span>
            </div>
            <div *ngIf="invoice.passpartu?.value">
              <span class="description">{{ "passpartu" | translate }}</span>
              <span>:</span>
              <span>{{ invoice.passpartu.value.name }}</span>
              <span>/</span>
              <span>{{ invoice.passpartu.width }}</span>
              <span></span>
              <span>{{ invoice.passpartu.uom }}</span>
            </div>
            <div *ngIf="invoice.glass">
              <span class="description">{{ "glass" | translate }}</span>
              <span>: </span>
              <span>{{ invoice.glass.name }}</span>
            </div>
            <div
              *ngIf="
                invoice.selectedFrames && invoice.selectedFrames.length > 0
              "
            >
              <span
                *ngIf="invoice.selectedFrames.length === 1"
                class="description"
              >
                {{ "frame" | translate }}
              </span>
              <span
                *ngIf="invoice.selectedFrames.length > 1"
                class="description"
              >
                {{ "frames" | translate }}
              </span>
              <span>: </span>
              <span
                *ngFor="let frame of invoice.selectedFrames; let ind = index"
              >
                <span *ngIf="ind > 0">, </span>
                {{ frame.name }}
              </span>
            </div>
          </div>
          <div class="grid-item">
            <div class="price">1000{{ currency }}</div>
          </div>
          <div class="grid-item">
            <app-button
              [iconName]="'edit'"
              buttonSize="small"
              [isTransparentMode]="true"
              (clickEvent)="editInvoiceItem()"
              class="button"
            ></app-button>
          </div>
          <div class="grid-item">
            <app-button
              [iconName]="'trash-2'"
              buttonSize="small"
              [isTransparentMode]="true"
              (clickEvent)="deleteInvoiceItem()"
              class="button"
            ></app-button>
          </div>
        </div>
        <div class="footer box-sizing-border-box">
          <app-button
            [text]="'previous' | translate"
            color="secondary"
            buttonSize="middle"
            (clickEvent)="stepper.previous()"
          ></app-button>
          <app-button
            [text]="'print' | translate"
            buttonSize="middle"
            [color]="'success'"
            (clickEvent)="printInvoice()"
          ></app-button>
        </div>
      </div>
    </mat-step>
  </mat-horizontal-stepper>
</div>
